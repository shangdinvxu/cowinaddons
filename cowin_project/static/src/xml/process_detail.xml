<?xml version="1.0" encoding="UTF-8"?>

<templates xml:space="preserve">

        <t t-name="KanbanView.nocontent">
            <div class="oe_view_nocontent">
                暂无内容
            </div>
        </t>


    <t t-name="project_process_detail_tmp">
        <div id="project_process_container" t-att-class="result.no_initate==true ? 'search_page':''">
            <div class="project_header">
                <h2><t t-esc="result.name"/></h2>
            </div>
            <div style="width:100%;height:10px;background:rgba(242, 242, 242, 1)"></div>
            <ul id="process_tab" class="nav nav-tabs">
                <li><a class="project_details" href="#process_detail" data-toggle="tab">详情</a></li>
                <li class="active"><a href="#process_data" data-toggle="tab">流程资料</a></li>
                <li><a class="operate_contacts" href="#process_contact" data-toggle="tab">联系人</a></li>
                <li><a class="operate_records" href="#process_record" data-toggle="tab">操作记录</a></li>
            </ul>
            <div id="process_tab_content" class="tab-content">
                <div class="tab-pane fade" id="process_detail">

                </div>
                <div class="tab-pane fade in active" id="process_data">
                    <div class="process_data_left_wrap">
                        <div class="process_data_rounds process_funds_rounds">
                            <div>项目流程</div>
                            <t t-set="active_flag" t-value="1"/>
                            <t t-foreach="result.investment_funds" t-as="item">
                                <div class="process_rounds_wrap">
                                    <strong><t t-esc="item.round_financing_name ? item.round_financing_name:''"/></strong>
                                    <ul>
                                        <t t-foreach="item.foundation_names" t-as="obj">
                                            <t t-if="active_flag==1">
                                                <li t-att-data-sub-id="obj.meta_sub_project_id" class="active_fund fund">
                                                    <t t-if="obj.foundation_name==''">
                                                        暂无基金
                                                    </t>
                                                    <t t-else="">
                                                        <t t-esc="obj.foundation_name"/> <span class="fa fa-chevron-right"></span>
                                                    </t>
                                                </li>
                                                <t t-set="active_flag" t-value="0"/>
                                            </t>
                                            <t t-else="">
                                                <li class="fund" t-att-data-sub-id="obj.meta_sub_project_id"><t t-esc="obj.foundation_name"/> </li>
                                            </t>
                                        </t>
                                    </ul>
                                </div>
                            </t>
                            <t t-if="result.whether_new_meta_sub_project_or_not==true">
                                <t t-if="result.no_initate==false">
                                    <div class="process_add_fun">
                                        <span><span class="fa fa-plus"></span> 新增基金</span>
                                    </div>
                                </t>
                            </t>
                        </div>

                        <!--项目查询里的项目若到了投后也要显示-->
                        <t t-if="result.prev_or_post_investment == false">
                            <t t-if="result.no_initate == true">
                                <div class="process_data_rounds process_funds_rounds post_investment">
                                    <div>投后管理</div>
                                    <t t-set="active_flag" t-value="1"/>
                                    <t t-foreach="result.investment_funds" t-as="item">
                                        <div class="process_rounds_wrap">
                                            <strong><t t-esc="item.round_financing_name ? item.round_financing_name:''"/></strong>
                                            <ul>
                                                <t t-foreach="item.foundation_names" t-as="obj">
                                                    <t t-if="active_flag==1">
                                                        <li t-att-data-sub-id="obj.meta_sub_project_id" class="fund">
                                                            <t t-if="obj.foundation_name==''">
                                                                暂无基金
                                                            </t>
                                                            <t t-else="">
                                                                <t t-esc="obj.foundation_name"/>
                                                            </t>
                                                        </li>
                                                        <t t-set="active_flag" t-value="0"/>
                                                    </t>
                                                    <t t-else="">
                                                        <li class="fund" t-att-data-sub-id="obj.meta_sub_project_id"><t t-esc="obj.foundation_name"/> </li>
                                                    </t>
                                                </t>
                                            </ul>
                                        </div>
                                    </t>
                                </div>
                            </t>
                        </t>


                        <div class="process_data_rounds">
                            <div>其他</div>
                            <ul style="padding-left:18px">
                                <li class="manage_team_btn">项目管理团队
                                    <t t-if="result.permission_configuration.default_is_full == false">
                                        <span class="no_perfect">未完善</span>
                                    </t>
                                    <span class="fa fa-chevron-right"></span>
                                </li>
                            </ul>
                        </div>
                    </div>

                    <div class="process_data_main_wrap">
                        <t t-call="process_info_right_tmpl">
                            <t t-set="result" t-value="result"></t>
                        </t>
                    </div>
                </div>
                <div class="tab-pane fade" id="process_contact">

                </div>
                <div class="tab-pane fade" id="process_record">

                </div>
            </div>
        </div>
    </t>

    <t t-name="process_info_right_tmpl">
        <t t-set="tache_index" t-value="0"/>
        <t t-foreach="result.process" t-as="item">
            <div class="process_data_item_line header_line">
                <span class="fa fa-folder-o"></span>
                <span><t t-esc="item.name"/> </span>
            </div>
            <t t-foreach="item.tache_ids" t-as="obj">
                <div class="process_data_item_line detail_line" t-att-data-tache-id="obj.id" t-att-tache-index="tache_index">
                    <t t-set="tache_index" t-value="tache_index + 1"/>
                    <span class="tache_name_"><t t-esc="obj.name"/></span>

                    <t t-if="obj.approval_status.status_id==-1">
                        <span>【同意】</span>
                    </t>
                    <t t-elif="obj.approval_status.status_id==5">
                        <span style="color:red">【<t t-esc="obj.approval_status.status_name"/>】</span>
                        <span class="gameover"><span class="fa fa-ban" style="color:red;margin-top:2px"></span>投资流程已终止</span>
                    </t>
                    <t t-else="">
                        <span>【<t t-esc="obj.approval_status.status_name"/>】</span>
                    </t>


                    <div class="button_wrap">
                        <t t-if="obj.is_unlocked==true">
                            <t t-if="obj.is_launch_again==true">
                                <span class="initiate" t-att-again="obj.is_launch_again"><a href="javascript:void(0)">重新发起</a></span>
                            </t>
                            <t t-if="obj.is_launch_again==false ">
                                <t t-if="obj.view_or_launch==true">
                                    <span class="view_tache"><a href="javascript:void(0)">查看</a></span>
                                    <t t-if="obj.once_or_more==true">
                                        <span class="add_new_tache"><a href="javascript:void(0)">新增</a></span>
                                    </t>
                                </t>
                                <t t-if="obj.view_or_launch==false">
                                    <span class="initiate" t-att-again="obj.is_launch_again"><a href="javascript:void(0)">发起</a></span>
                                </t>
                            </t>
                            <t t-if="!obj.is_launch_again and obj.parent_id==false">
                                <span class="view_tache"><a href="javascript:void(0)">查看</a></span>
                            </t>
                            <!--<t t-if="obj.view_or_launch==true">-->
                                <!--<span class="view_tache"><a href="javascript:void(0)">查看</a></span>-->
                            <!--</t>-->
                            <!--<t t-elif="obj.view_or_launch==false">-->
                                <!--<t t-if="result.no_initate==false">-->
                                    <!--<span class="initiate"><a href="javascript:void(0)">发起</a></span>-->
                                <!--</t>-->
                            <!--</t>-->
                             <!--<t t-elif="obj.view_or_launch==null">-->
                                <!--&lt;!&ndash;<span class="initiate"><a href="javascript:void(0)">发起</a></span>&ndash;&gt;-->
                            <!--</t>-->
                        </t>
                    </div>
                </div>
            </t>
        </t>
    </t>

    <t t-name="process_info_left_tmpl">
        <div>项目流程</div>
        <!--<t t-set="active_flag" t-value="1"/>-->
        <t t-foreach="result.investment_funds" t-as="item">
            <div class="process_rounds_wrap">
                <strong><t t-esc="item.round_financing_name ? item.round_financing_name:''"/></strong>
                <ul>
                    <t t-foreach="item.foundation_names" t-as="obj">
                        <t t-if="active_flag== obj.meta_sub_project_id">
                            <li t-att-data-sub-id="obj.meta_sub_project_id" class="active_fund fund">
                                <t t-if="obj.foundation_name==''">
                                    暂无基金
                                </t>
                                <t t-else="">
                                    <t t-esc="obj.foundation_name"/> <span class="fa fa-chevron-right"></span>
                                </t>
                            </li>
                            <t t-set="active_flag" t-value="0"/>
                        </t>
                        <t t-else="">
                            <li class="fund" t-att-data-sub-id="obj.meta_sub_project_id"><t t-esc="obj.foundation_name"/> </li>
                        </t>
                    </t>
                </ul>
            </div>
        </t>
    </t>


    <!--项目管理团队页面-->
    <t t-name="project_manage_team_tmp">
        <t t-foreach="result.meta_sub_project_infos" t-as="item">
            <div class="process_data_item_line header_line" t-att-meta_sub_pro_id="item.meta_sub_pro_id">
                <span class="fa fa-user"></span>
                <span><t t-esc="item.foundation_for_rund_financing_info"/> </span>
                <t t-if="edit==true">
                    <span class="copy_this_setting">复制已有配置</span>
                </t>
                <t t-if="result.is_admin==true">
                    <span class="manage_team_edit">编辑</span>
                </t>
            </div>
            <div class="detail_lines_wrap" t-att-meta_sub_pro_id="item.meta_sub_pro_id">
                <t t-foreach="item.approval_role_infos" t-as="obj">
                    <div class="process_data_item_line detail_line" t-att-approval_role_id="obj.approval_role_id" t-att-need_call_rpc="obj.need_call_rpc">
                        <span class="team_role"><t t-esc="obj.approval_role_name"/></span>
                        <div class="team_role_names_wrap">

                            <t t-call="names_tmpl">
                                <t t-set="is_admin" t-value="result.is_admin"></t>
                                <t t-set="result" t-value="obj.employee_infos"></t>
                                <t t-set="edit" t-value="edit"></t>
                                <t t-set="is_readonly" t-value="obj.is_readonly"></t>
                            </t>

                            <t t-if="edit==true">
                                <t t-if="obj.is_readonly==false">
                                    <span class="add_new_role">新增</span>
                                </t>
                            </t>
                        </div>
                    </div>
                </t>
            </div>
        </t>

        <t t-if="edit==true">
            <div class="btns_wrap">
                <div class="confirm_project_team_setting">保存</div>
                <div class="cancel_project_team_setting">取消</div>
            </div>
        </t>


        <!--新增选择人员-->
        <div class="add_new_wrap">
            <div class="modal-backdrop  in"></div>
            <div class="add_new_content">
                <div class="add_new_head">
                    请选择员工
                    <!--<span class="fa fa-close"></span>-->
                </div>
                <div class="add_new_body">
                    <select class="selectpicker bla bla bli" multiple="true" data-live-search="true">
                        <t t-foreach="result.employee_infos" t-as="item">
                            <option t-att-data-id="item.employee_id"><t t-esc="item.name"/></option>
                        </t>
                    </select>
                    <script>
                        $('.selectpicker').selectpicker({
                            'selectedText': 'cat'
                        });
                    </script>
                </div>
                <div class="add_new_foot">
                    <span class="confirm_sel">确定</span>
                    <span class="cancel_sel">取消</span>
                </div>
            </div>
        </div>
    </t>



    <!--项目管理团队新增人员的选择-->
    <t t-name="add_new_objs">
        <select class="selectpicker bla bla bli" multiple="true" data-live-search="true">
            <t t-foreach="result" t-as="item">
                <t t-if="type==1">
                    <option class="weiyuan" t-att-data-id="item.employee_ids" t-att-data-scope-id="item.investment_decision_committee_scope_id">
                        <t t-esc="item.name"/>
                    </option>
                </t>
                <t t-elif="type==2">
                    <option class="guanli" t-att-data-id="item.id">
                        <t t-esc="item.name_related"/>
                    </option>
                </t>
                <t t-elif="type==3">
                    <option class="sd" t-att-data-id="item.employee_id">
                        <t t-esc="item.name"/>
                    </option>
                </t>
            </t>
        </select>
        <script>
            $('.selectpicker').selectpicker({
                'selectedText': 'cat'
            });
        </script>
    </t>



    <!--项目管理团队编辑页面-->
    <t t-name="manage_team_edit_page">
        <div class="manage_team_edit_wrap">
            <div class="modal-backdrop  in"></div>
            <div class="add_new_content">
                <t t-call="project_manage_team_tmp">
                    <t t-set="is_admin" t-value="result.is_admin"></t>
                    <t t-set="result" t-value="result"></t>
                </t>
            </div>
        </div>
    </t>

    <!--内部-->
    <t t-name="names_tmpl">
        <t t-foreach="result" t-as="item">
            <span class="member_name" t-att-employee_id="item.employee_id" t-att-weiyuan="weiyuan">
                <t t-esc="item.name"/>
                <t t-if="edit==true">
                    <t t-if="is_readonly==false">
                        <span class="fa fa-close"></span>
                    </t>
                </t>
            </span>
        </t>
    </t>

    <t t-name="copy_settings_tmpl">
        <div class="copy_wrap">
            <div class="modal-backdrop  in"></div>
            <div class="add_new_content">
                <div class="add_new_head">
                    请选择要复制的项目管理团队
                    <!--<span class="fa fa-close"></span>-->
                </div>
                <div class="add_new_body">
                    <select class="selectpicker bla bla bli copy_sel" data-live-search="true">
                        <t t-foreach="result" t-as="item">
                            <t t-if="item.meta_sub_project_id != current">
                                <option t-att-data-id="item.meta_sub_project_id">
                                    <span><t t-esc="item.sub_project_name"/> </span>
                                    <span><t t-esc="item.round_financing_name"/> </span>
                                    <span><t t-esc="item.foundation_name"/> </span>
                                </option>
                            </t>

                        </t>
                    </select>
                    <script>
                        $('.selectpicker').selectpicker({
                            'selectedText': 'cat'
                        });
                    </script>
                </div>
                <div class="add_new_foot">
                    <span class="confirm_copy">确定</span>
                    <span class="cancel_sel">取消</span>
                </div>
            </div>
        </div>
    </t>

    <!--tab 操作记录-->
    <t t-name="operate_records_tmpl">
        <t t-foreach="result.operation_records" t-as="item">
            <div class="record_item_wrap">
                <span class="fa fa-user"></span>
                <div class="record_item">
                    <div style="overflow:hidden;">
                        <span style="float:left;font-size:16px;font-weight:bold;"><t t-esc="item.body.approval_roel_person"/></span>
                        <span style="float:right;color:#949494;"><t t-esc="item.body.operation_time"/></span>
                    </div>
                    <div>
                        <span style="color:#949494">
                            <t t-esc="item.body.operation"/>【<t t-esc="item.body.sub_project_name"/>/<t t-esc="item.body.round_financing_name"/>/<t t-esc="item.body.foundation_name"/> 】
                            <t t-esc="item.body.sub_tache_name"/>
                        </span>
                    </div>
                </div>
            </div>
        </t>
    </t>

    <!--tab 联系人-->
    <t t-name="operate_contacts_templ">
        <t t-foreach="result.contract_infos" t-as="item">
            <div class="process_contact_wrap">
                <div style="font-weight:bolder;font-size:18px;color:#000"><t t-esc="item.contract_person"/></div>
                <div>联系电话：<t t-esc="item.contract_phone"/></div>
                <div>邮箱：<t t-esc="item.contract_email"/></div>
                <div>相关项目：<t t-esc="item.related_sub_project"/></div>
                <div>公司名称：<t t-esc="item.company_name"/></div>
                <div>职位：<t t-esc="item.customer_position"/> </div>
            </div>
        </t>
    </t>

    <!--tab 详情-->
    <t t-name="process_deatil_tmpl">
        <div class="process_detail_container">
            <div class="add_new_invest">
                <span class="fa fa-plus"></span> 新增外部投资
            </div>
            <table class="table">
                <thead style="background-color:rgba(242, 242, 242, 0.9)">
                    <tr>
                        <th>投资方</th>
                        <th>公司估值</th>
                        <th>本次融资额</th>
                        <th>投资金额</th>
                        <th>股份比例</th>
                        <th>退出情况</th>
                        <th style="width:100px"></th>
                    </tr>
                </thead>
                <tbody>
                    <t t-set="tab_detail_item_index" t-value="0"/>
                    <t t-foreach="result" t-as="item">
                        <tr class="financing" t-att-round-financing-id="item.id">
                            <td>
                              <t t-esc="item.name"/>
                            </td>
                        </tr>
                        <t t-foreach="item.data" t-as="obj">
                            <tr t-att-foundation-id="obj.foundation_id" t-att-item-index="tab_detail_item_index">
                                <t t-set="tab_detail_item_index" t-value="tab_detail_item_index + 1"/>
                                <td class="foundation"><t t-esc="obj.foundation"/></td>
                                <td class="project_valuation"><t t-esc="obj.project_valuation"/></td>
                                <td class="the_amount_of_financing"><t t-esc="obj.the_amount_of_financing"/></td>
                                <td class="the_amount_of_investment"><t t-esc="obj.the_amount_of_investment"/></td>
                                <td class="ownership_interest"><t t-esc="obj.ownership_interest"/></td>
                                <td>
                                    <t t-if="obj.withdrawals.length==0">
                                        无
                                    </t>
                                    <t t-else="">
                                        <span class="tab_detail_view_item">查看</span>
                                    </t>
                                </td>
                                <td class="btn_wrap">
                                    <t t-if="obj.data_from=='external'">
                                        <span class="edit">编辑</span>
                                        <span class="delete">删除</span>
                                    </t>
                                </td>
                            </tr>
                        </t>
                    </t>
                </tbody>
            </table>
        </div>

        <!--新增外部投资-->
        <div class="add_external_invest_wrap">
            <div class="modal-backdrop in"></div>
            <div class="add_content">
                <div class="add_header">新增投资</div>
                <div class="invest_infos">
                    <p>投资情况</p>
                    <div class="invest_infos_item">
                        <div><span style="color:red">*</span>投资轮次: </div>
                        <div class="add_invest_select">

                        </div>
                    </div>
                    <div class="invest_infos_item">
                        <div><span style="color:red">*</span>投资方名称: </div>
                        <div>
                            <input class="foundation" type="text"/>
                        </div>
                    </div>
                    <div class="invest_infos_item">
                        <div><span style="color:red">*</span>本次融资额: </div>
                        <div>
                            <input class="the_amount_of_financing" type="text"/>
                        </div>
                    </div>
                    <div class="invest_infos_item">
                        <div><span style="color:red">*</span>投资金额: </div>
                        <div>
                            <input class="the_amount_of_investment" type="text"/>
                        </div>
                    </div>
                    <div class="invest_infos_item">
                        <div><span style="color:red">*</span>公司估值: </div>
                        <div>
                            <input class="project_valuation" type="text"/>
                        </div>
                    </div>
                </div>
                <div class="invest_exit_infos">
                    <p>退出情况</p>
                    <table class="table">
                        <thead>
                            <tr style="background-color:#F2F2F2">
                                <th>退出时公司估值</th>
                                <th>退出金额</th>
                                <th>退出比例</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="value_info">
                                <td><input class="project_valuation" type="text"/></td>
                                <td><input class="the_amount_of_withdrawals" type="text"/></td>
                                <td><input class="ownership_interest" type="text" disabled="disabled"/></td>
                            </tr>
                            <tr class="add_btn">
                                <td style="cursor:pointer">添加</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="add_invest_foot">
                    <span class="save">保存</span>
                    <span class="cancel">取消</span>
                </div>
            </div>
        </div>


        <div class="tab_detail_view_withdraw_wrap">
            <div class="modal-backdrop in"></div>
            <div class="exit_detail_content">
                <div class="header">退出情况</div>
                <span class="fa fa-times close"></span>
                <table class="table">
                    <thead>
                        <tr style="background-color:#F2F2F2">
                            <th>退出时公司估值</th>
                            <th>退出金额</th>
                            <th>退出比例</th>
                        </tr>
                    </thead>
                    <tbody>

                    </tbody>
                </table>
            </div>
        </div>
    </t>

    <!--退出情况详情-->
    <t t-name="view_withdraw_tmpl">
        <t t-foreach="result" t-as="item">
            <tr>
                <td><t t-esc="item.project_valuation"/></td>
                <td><t t-esc="item.the_amount_of_withdrawals"/></td>
                <td><t t-esc="item.ownership_interest"/></td>
            </tr>
        </t>
    </t>

    <!--新增投资的投资轮次选择模板-->
    <t t-name="add_invest_select_tmpl">
        <select style="width:100%">
            <t t-foreach="result" t-as="item">
                <option t-att-data-id="item.id"><t t-esc="item.name"/></option>
            </t>
        </select>
    </t>

    <!--退出情况的模板-->
    <t t-name="withdraw_infos_tmpl">
        <t t-if="result.length==0">
            <tr class="value_info">
                <td><input class="project_valuation" type="text"/></td>
                <td><input class="the_amount_of_withdrawals" type="text"/></td>
                <td><input class="ownership_interest" type="text" disabled="disabled"/></td>
            </tr>
        </t>
        <t t-else="">
            <t t-foreach="result" t-as="item">
                <tr class="value_info">
                    <td><input type="text" disabled="disabled" t-att-value="item.project_valuation"/></td>
                    <td><input type="text" disabled="disabled" t-att-value="item.the_amount_of_withdrawals"/></td>
                    <td><input type="text" disabled="disabled" t-att-value="item.ownership_interest"/></td>
                </tr>
            </t>
        </t>
        <tr class="add_btn">
            <td class="cursor:pointer">添加</td>
        </tr>
    </t>

</templates>